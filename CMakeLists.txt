project(QtCmakeCxxTestDoxygen)

cmake_minimum_required(VERSION 2.8)
set(CMAKE_AUTOMOC TRUE)

if(NOT CMAKE_BUILD_TYPE)
    set(CMAKE_BUILD_TYPE "Release" CACHE STRING "" FORCE)
endif()

if(NOT CMAKE_BUILD_TYPE MATCHES "^[Dd][Ee][Bb][Uu][Gg]")
    add_definitions(-DQT_NO_DEBUG_OUTPUT)
    set(CMAKE_BUILD_RELEASE TRUE)
else()
    set(CMAKE_BUILD_RELEASE FALSE)
endif()

message(STATUS "Building ${PROJECT_NAME} in ${CMAKE_BUILD_TYPE} mode")

set(PROJECT_VERSION_MAJOR "0")
set(PROJECT_VERSION_MINOR "2")
set(PROJECT_VERSION_PATCH "0")
set(PROJECT_VERSION_COUNT 3)
set(PROJECT_VERSION "${PROJECT_VERSION_MAJOR}.${PROJECT_VERSION_MINOR}.${PROJECT_VERSION_PATCH}")
set(PROJECT_VENDOR "Bram Vogelaar")
set(PROJECT_COPYRIGHT_YEAR "2011")
set(PROJECT_DOMAIN_FIRST "attachmentgenie")
set(PROJECT_DOMAIN_SECOND "com")
set(PROJECT_DOMAIN "${PROJECT_DOMAIN_FIRST}.${PROJECT_DOMAIN_SECOND}")
set(LICENSE_FILE "docs/LICENSE.txt")
set(README_FILE "README.md")
set(ICONS_DIR "${${PROJECT_NAME}_SOURCE_DIR}/gui/images/icons")
set(CMAKE_INSTALL_SYSTEM_RUNTIME_DESTINATION "${BIN_INSTALL_DIR}")
set(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/cmake")

if(APPLE)
    set(EXECUTABLE "${PROJECT_NAME}.app")
    set(CMAKE_INSTALL_PREFIX "/Applications")
    set(BIN_INSTALL_DIR ".")
    set(DOC_INSTALL_DIR ".")
elseif(WIN32)
    set(EXECUTABLE "${PROJECT_NAME}${CMAKE_EXECUTABLE_SUFFIX}")
    set(BIN_INSTALL_DIR ".")
    set(DOC_INSTALL_DIR ".")
    install(FILES "${LICENSE_FILE}" "${README_FILE}" DESTINATION ${DOC_INSTALL_DIR})
elseif(UNIX AND NOT APPLE)
    string(TOLOWER ${PROJECT_NAME} PROJECT_NAME_LOWERCASE)
    set(BIN_INSTALL_DIR "bin")
    set(DOC_INSTALL_DIR "share/doc/${PROJECT_NAME_LOWERCASE}/")
    set(EXECUTABLE "${BIN_INSTALL_DIR}/${PROJECT_NAME}${CMAKE_EXECUTABLE_SUFFIX}")
    install(FILES "${LICENSE_FILE}" "${README_FILE}" DESTINATION ${DOC_INSTALL_DIR})
endif()

find_package(Qt4 COMPONENTS QtMain QtCore QtGui REQUIRED)
include(UseQt4)
include(InstallRequiredSystemLibraries)
if(APPLE OR WIN32)
    include(DeployQt4)
    install_qt4_executable("${EXECUTABLE}")
endif()

add_subdirectory (cli)
add_subdirectory (gui)
add_subdirectory (server)

add_subdirectory (docs) 
add_subdirectory (installer)

add_custom_target(RELEASE
    COMMENT "Place actual REPLACE target here."
)