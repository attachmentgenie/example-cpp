# add the main library
add_SWIG_LIBRARY(library example.cxx)

install (TARGETS library DESTINATION bin)
install (FILES example.h DESTINATION include)

#add the swig exports
option(BUILD_SWIG_ENDPOINTS "Build SWIG endpoints" ON)
option(BUILD_SWIG_PYTHON_LIBRARY "Build python library" ON)
option(BUILD_SWIG_PERL_LIBRARY "Build perl library" ON)

if(BUILD_SWIG_ENDPOINTS)
	INCLUDE_DIRECTORIES(${CMAKE_CURRENT_SOURCE_DIR})

	FIND_PACKAGE(SWIG REQUIRED)
	INCLUDE(${SWIG_USE_FILE})

	SET(CMAKE_SWIG_FLAGS "")
	set(CMAKE_SWIG_OUTDIR ${CMAKE_CURRENT_BINARY_DIR}/${CMAKE_BUILD_TYPE})

	SET_SOURCE_FILES_PROPERTIES(example.i PROPERTIES CPLUSPLUS ON)
	SET_SOURCE_FILES_PROPERTIES(example.i PROPERTIES SWIG_FLAGS "-includeall")

	if(BUILD_SWIG_PYTHON_LIBRARY)
		FIND_PACKAGE(PythonLibs)
		INCLUDE_DIRECTORIES(${PYTHON_INCLUDE_PATH})

		SWIG_ADD_MODULE(python python example.i example.cxx)
		SWIG_LINK_LIBRARIES(python ${PYTHON_LIBRARIES})
		SET_TARGET_PROPERTIES(_python PROPERTIES OUTPUT_NAME example)

		INSTALL(TARGETS _python DESTINATION share/python)
		INSTALL(FILES ${CMAKE_CURRENT_BINARY_DIR}/${CMAKE_BUILD_TYPE}/example.py DESTINATION share/python)
	endif(BUILD_SWIG_PYTHON_LIBRARY)

	if(BUILD_SWIG_PERL_LIBRARY)
		FIND_PACKAGE(PerlLibs)
		INCLUDE_DIRECTORIES(${PERL_INCLUDE_PATH})

		SWIG_ADD_MODULE(perl perl example.i example.cxx)
		SWIG_LINK_LIBRARIES(perl ${PERL_LIBRARIES})
		SET_TARGET_PROPERTIES(perl PROPERTIES OUTPUT_NAME example)

		INSTALL(TARGETS perl DESTINATION share/perl)
		INSTALL(FILES ${CMAKE_CURRENT_BINARY_DIR}/${CMAKE_BUILD_TYPE}/example.pm DESTINATION share/perl)
	endif(BUILD_SWIG_PERL_LIBRARY)
endif(BUILD_SWIG_ENDPOINTS)